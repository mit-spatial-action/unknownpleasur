# unknownpleasur

<!-- badges: start -->
[![R-CMD-check](https://github.com/mit-spatial-action/unknownpleasur/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/mit-spatial-action/unknownpleasur/actions/workflows/R-CMD-check.yaml) [![License](https://img.shields.io/badge/License-BSD_2--Clause-orange.svg)](https://opensource.org/licenses/BSD-2-Clause) [![Project Status: WIP â€“ Initial development is in progress, but there has not yet been a stable, usable release suitable for the public.](https://www.repostatus.org/badges/latest/wip.svg)](https://www.repostatus.org/#wip) [![DOI](https://zenodo.org/badge/750539523.svg)](https://doi.org/10.5281/zenodo.15366842)
<!-- badges: end -->

![Sample map generated by st_unknown_pleasures.](media/logo.png)

Generates regular section cuts through a raster surface for a given extent. Produces results that look quite a lot like the cover of Joy Division's _Unknown Pleasures_ (1979). Also quite a lot like some of the work of the Harvard Laboratory for Computer Graphics and Spaital Analysis (RIP). Also, scholarly integrity requires that I say: [James Cheshire got here first.](https://jcheshire.com/resources/joy-division-population-surfaces-and-pioneering-electronic-cartography/)

## Installation

Submission to CRAN is forthcoming at release `v0.1.0`. Until then, you can install the development version (ðŸ‘‹ hi! ðŸ‘‹) with devtools as follows...

```r
devtools::install_github("mit-spatial-action/unknownpleasur")
```

## Getting Started

General workflow looks like the below. Assuming an `sf` dataframe containing polygons or multipolygons (`polygons`) and a raster surface (`raster`), this generates regularly spaced lines (`st_regular_lines()`) and effecitvely "drapes" them over a raster surface, returning either polygonal or linestring section cuts (`st_unknown_pleasures()`).

Orientation and number of cut lines is set through `get_dims()` which returns a set of parameters that are subsequently passed to `st_regular_lines()` and `st_unknown_pleasures()`.

```r
dims <- get_dims(polygons, n = 100, type = "vertical") # or "horizontal"

lines <- polygons %>%
  st_union() %>%
  st_regular_lines(
    dims = dims,
    mask = TRUE
  )

unknown_pleasures <- lines %>%
  st_unknown_pleasures(
    raster,
    dims = dims,
    sample_size = 250, 
    bleed_factor = 3,
    # Or "planar"
    mode = "xyz",
    # Strictly speaking, the "xyz" and polygon
    # combination leaves you with closed LINESTRINGs
    polygon = TRUE
  ) %>%
  st_geometry() %>%
  # We devized the "xyz" mode for export to 3D Modeling software (e.g.,
  # Rhino), so we export to dxf.
  st_write( 
    "test_polys.dxf", 
    delete_dsn = TRUE, 
    driver = "dxf"
    )
```

<img width="1651" alt="dxf_screenshot" src="https://user-images.githubusercontent.com/10646361/226750060-e9370477-d71b-43ba-9514-76f43abfaed0.png">


```r
# Or, for more GIS-ready output...
unknown_pleasures <- lines %>%
  st_unknown_pleasures(
    raster,
    dims = dims,
    sample_size = 250, 
    bleed_factor = 3,
    mode = "planar",
    polygon = TRUE
  ) %>%
  st_write( 
    "test_polys.geojson", 
    delete_dsn = TRUE
    )

```

![Sample map generated by st_unknown_pleasures.](media/logo.png)
